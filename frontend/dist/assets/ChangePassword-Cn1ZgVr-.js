import{_ as f,r as i,c as v,a,w as s,b as V,d as b,e as t,E as n,f as g,l as y,u as x,o as C}from"./index-BJpBMmue.js";const h={class:"change-password-page"},k={__name:"ChangePassword",setup(B){const u=x(),e=i({old_password:"",new_password:"",confirm_password:""}),_=async()=>{var p,o;if(!e.value.old_password||!e.value.new_password){n.error("请完整填写表单");return}if(e.value.new_password!==e.value.confirm_password){n.error("两次输入的新密码不一致");return}try{await g.changePassword({old_password:e.value.old_password,new_password:e.value.new_password}),n.success("密码修改成功，请重新登录"),u.dispatch("logout"),y()}catch(l){console.error(l),n.error(((o=(p=l.response)==null?void 0:p.data)==null?void 0:o.detail)||"修改失败")}};return(p,o)=>{const l=t("el-input"),d=t("el-form-item"),m=t("el-button"),w=t("el-form"),c=t("el-card");return C(),v("div",h,[a(c,null,{default:s(()=>[o[4]||(o[4]=V("h3",null,"修改密码",-1)),a(w,{model:e.value,"label-width":"120px"},{default:s(()=>[a(d,{label:"旧密码"},{default:s(()=>[a(l,{modelValue:e.value.old_password,"onUpdate:modelValue":o[0]||(o[0]=r=>e.value.old_password=r),type:"password",placeholder:"请输入旧密码"},null,8,["modelValue"])]),_:1}),a(d,{label:"新密码"},{default:s(()=>[a(l,{modelValue:e.value.new_password,"onUpdate:modelValue":o[1]||(o[1]=r=>e.value.new_password=r),type:"password",placeholder:"请输入新密码（至少6位）"},null,8,["modelValue"])]),_:1}),a(d,{label:"确认新密码"},{default:s(()=>[a(l,{modelValue:e.value.confirm_password,"onUpdate:modelValue":o[2]||(o[2]=r=>e.value.confirm_password=r),type:"password",placeholder:"请再次输入新密码"},null,8,["modelValue"])]),_:1}),a(d,null,{default:s(()=>[a(m,{type:"primary",onClick:_},{default:s(()=>[...o[3]||(o[3]=[b("修改密码",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},N=f(k,[["__scopeId","data-v-964d1072"]]);export{N as default};
