import{_ as b,r as f,g as y,c as U,a,w as t,b as x,d as w,h as g,e as u,f as k,E as _,u as C,o as B}from"./index-BJpBMmue.js";const E={class:"profile-page"},N={__name:"Profile",setup(P){const d=C(),c=f(null),l=f({username:"",email:"",full_name:""}),p=async()=>{try{const e=(await g()).data;l.value.username=e.username,l.value.email=e.email||"",l.value.full_name=e.full_name||"",d.dispatch("setUser",e)}catch(s){console.error("加载用户失败",s)}},i=async()=>{var s,e;try{const o={email:l.value.email,full_name:l.value.full_name},m=(await k.updateProfile(o)).data;d.dispatch("setUser",m),_.success("资料更新成功")}catch(o){console.error(o),_.error(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.detail)||"更新失败")}};return y(()=>{p()}),(s,e)=>{const o=u("el-input"),n=u("el-form-item"),m=u("el-button"),v=u("el-form"),V=u("el-card");return B(),U("div",E,[a(V,null,{default:t(()=>[e[4]||(e[4]=x("h3",null,"个人中心",-1)),a(v,{model:l.value,ref_key:"formRef",ref:c,"label-width":"90px"},{default:t(()=>[a(n,{label:"用户名"},{default:t(()=>[a(o,{modelValue:l.value.username,"onUpdate:modelValue":e[0]||(e[0]=r=>l.value.username=r),disabled:""},null,8,["modelValue"])]),_:1}),a(n,{label:"邮箱"},{default:t(()=>[a(o,{modelValue:l.value.email,"onUpdate:modelValue":e[1]||(e[1]=r=>l.value.email=r),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),a(n,{label:"姓名"},{default:t(()=>[a(o,{modelValue:l.value.full_name,"onUpdate:modelValue":e[2]||(e[2]=r=>l.value.full_name=r),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),a(n,null,{default:t(()=>[a(m,{type:"primary",onClick:i},{default:t(()=>[...e[3]||(e[3]=[w("保存",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},M=b(N,[["__scopeId","data-v-efae332f"]]);export{M as default};
